DROP SCHEMA IF EXISTS PizzaDB;
CREATE SCHEMA PizzaDB;
USE PizzaDB;

DROP USER IF EXISTS 'dbtester';
CREATE USER 'dbtester' IDENTIFIED BY 'CPSC4620';
GRANT ALL ON PizzaDB.* TO 'dbtester';

CREATE TABLE CUSTOMER (
    CustID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    FName VARCHAR(30),
    LName VARCHAR(30),
    PhoneNum VARCHAR(30)
);

CREATE TABLE ORDERTABLE (
    OrderID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    OrderType VARCHAR(30) NOT NULL,
    OrderDateTime DATETIME NOT NULL,
    CustPrice DECIMAL(5,2) NOT NULL,
    BusPrice DECIMAL(5,2) NOT NULL,
    isComplete BOOLEAN NOT NULL,
    CustID INT NOT NULL,
    CONSTRAINT `CustID` FOREIGN KEY(`CustID`) REFERENCES `CUSTOMER` (`CustID`)
);

CREATE TABLE PICKUP (
    OrderID INT PRIMARY KEY,
    IsPickedUp BOOLEAN NOT NULL,
    CONSTRAINT `picked_OrderID` FOREIGN KEY(`OrderID`) REFERENCES `ORDERTABLE` (`OrderID`) ON DELETE CASCADE
);

CREATE TABLE DELIVERY (
    OrderID INT PRIMARY KEY,
    HouseNum INT NOT NULL,
    Street VARCHAR(30) NOT NULL,
    City VARCHAR(30) NOT NULL,
    State VARCHAR(2) NOT NULL,
    Zip INT NOT NULL,
    IsDelivered BOOLEAN NOT NULL,
    CONSTRAINT `delivery_OrderID` FOREIGN KEY(`OrderID`) REFERENCES `ORDERTABLE` (`OrderID`) ON DELETE CASCADE
);

CREATE TABLE DINEIN (
    OrderID INT PRIMARY KEY,
    TableNum INT NOT NULL,
    CONSTRAINT `dineIn_OrderID` FOREIGN KEY(`OrderID`) REFERENCES `ORDERTABLE`(`OrderID`) ON DELETE CASCADE
);

CREATE TABLE PIZZA (
    PizzaID INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    Size VARCHAR(30) NOT NULL,
    CrustType VARCHAR(30) NOT NULL,
    PizzaState VARCHAR(30) NOT NULL,
    PizzaDate DATETIME NOT NULL,
    CustPrice DECIMAL(5,2) NOT NULL,
    BusPrice DECIMAL(5,2) NOT NULL,
    OrderID INT NOT NULL,
    CONSTRAINT `pizza_OrderID` FOREIGN KEY(`OrderID`) REFERENCES `ORDERTABLE` (`OrderID`)
);

CREATE TABLE BASEPRICE (
    Size VARCHAR(30) NOT NULL,
    CrustType VARCHAR(30) NOT NULL,
    CustPrice DECIMAL(5,2) NOT NULL,
    BusPrice DECIMAL(5,2) NOT NULL
);

CREATE TABLE TOPPING (
    TopID INT PRIMARY KEY NOT NULL,
    TopName VARCHAR(30) NOT NULL,
    SmallAMT DECIMAL(5, 2) NOT NULL,
    MedAMT DECIMAL(5, 2) NOT NULL,
    LgAMT DECIMAL(5, 2) NOT NULL,
    XLAMT DECIMAL(5, 2) NOT NULL,
    CustPrice DECIMAL(5, 2) NOT NULL,
    BusPrice DECIMAL(5, 2) NOT NULL,
    MinINVT INT NOT NULL,
    CurINVT INT NOT NULL
 );

CREATE TABLE PIZZA_TOPPING (
    PizzaID INT NOT NULL,
    TopID INT NOT NULL,
    IsDouble INT NOT NULL,
    CONSTRAINT `fk_PizzaID` FOREIGN KEY(`PizzaID`) REFERENCES `PIZZA` (`PizzaID`),
    CONSTRAINT `fk_TopID` FOREIGN KEY(`TopID`) REFERENCES `TOPPING` (`TopID`)
);

CREATE TABLE DISCOUNT (
    DiscountID INT PRIMARY KEY NOT NULL,
    DiscountName VARCHAR(30) NOT NULL,
    Amount DECIMAL(5,2),
    IsPercent BOOLEAN
);

CREATE TABLE PIZZA_DISCOUNT (
    PizzaID INT NOT NULL,
    DiscountID INT NOT NULL,
    CONSTRAINT `PizzaID` FOREIGN KEY(`PizzaID`) REFERENCES `PIZZA`(`PizzaID`),
    CONSTRAINT `DiscountID` FOREIGN KEY(`DiscountID`) REFERENCES `DISCOUNT`(`DiscountID`)
);

CREATE TABLE ORDER_DISCOUNT (
    OrderID INT NOT NULL,
    DiscountID INT NOT NULL,
    CONSTRAINT `fk_OrderID` FOREIGN KEY(`OrderID`) REFERENCES `ORDERTABLE` (`OrderID`),
    CONSTRAINT `fk_DiscountID` FOREIGN KEY(`DiscountID`) REFERENCES `DISCOUNT` (`DiscountID`)
);

INSERT INTO TOPPING VALUES(1, 'Pepperoni', 2, 2.75, 3.5, 4.5, 1.25, 0.2,50, 100);
INSERT INTO TOPPING VALUES(2, 'Sausage', 2.5, 3, 3.5, 4.25, 1.25, 0.15, 50, 100);
INSERT INTO TOPPING VALUES(3,'Ham', 2, 2.5, 3.25, 4, 1.5, 0.15, 25, 78);
INSERT INTO TOPPING VALUES(4, 'Chicken', 1.5, 2, 2.25, 3, 1.75, 0.25, 25, 56);
INSERT INTO TOPPING VALUES(5, 'Green Pepper', 1, 1.5, 2, 2.5, 0.5, 0.02, 25, 79);
INSERT INTO TOPPING VALUES(6, 'Onion', 1, 1.5, 2, 2.75, 0.5, 0.02, 25, 85);
INSERT INTO TOPPING VALUES(7, 'Roma Tomato', 2, 3, 3.5, 4.5, 0.75, 0.03, 10, 86);
INSERT INTO TOPPING VALUES(8, 'Mushrooms', 1.5, 2, 2.5, 3, 0.75, 0.1, 50, 52);
INSERT INTO TOPPING VALUES(9, 'Black Olives', 0.75, 1, 1.5, 2, 0.6, 0.1, 25, 39);
INSERT INTO TOPPING VALUES(10, 'Pineapple', 1, 1.25, 1.75, 2, 1, 0.25, 0, 15);
INSERT INTO TOPPING VALUES(11, 'Jalapenos', 0.5, 0.75, 1.25, 1.75, 0.5, 0.05, 0, 64);
INSERT INTO TOPPING VALUES(12, 'Banana Peppers', 0.6, 1, 1.3, 1.75, 0.5, 0.05, 0, 36);
INSERT INTO TOPPING VALUES(13, 'Regular Cheese', 2, 3.5, 5,7, 0.5, 0.12, 50, 250);
INSERT INTO TOPPING VALUES(14, 'Four Cheese Blend', 2, 3.5, 5, 7, 1, 0.15, 25, 150);
INSERT INTO TOPPING VALUES(15, 'Feta Cheese', 1.75, 3, 4, 5.5, 1.5, 0.18, 0, 75);
INSERT INTO TOPPING VALUES(16, 'Goat Cheese', 1.6, 2.75, 4, 5.5, 1.5, 0.2, 0, 54);
INSERT INTO TOPPING VALUES(17, 'Bacon', 1, 1.5, 2, 3, 1.5, 0.25, 0, 89);


INSERT INTO BASEPRICE VALUES('Small', 'Thin', 3, 0.5);
INSERT INTO BASEPRICE VALUES('Small', 'Original', 3, 0.75);
INSERT INTO BASEPRICE VALUES('Small', 'Pan', 3.5, 1);
INSERT INTO BASEPRICE VALUES('Small', 'Gluten-Free', 4, 2);
INSERT INTO BASEPRICE VALUES('Medium', 'Thin', 5, 1);
INSERT INTO BASEPRICE VALUES('Medium', 'Original', 5, 1.5);
INSERT INTO BASEPRICE VALUES('Medium', 'Pan', 6, 2.25);
INSERT INTO BASEPRICE VALUES('Medium', 'Gluten-Free', 6.25, 3);
INSERT INTO BASEPRICE VALUES('Large', 'Thin', 8, 1.25);
INSERT INTO BASEPRICE VALUES('Large', 'Original', 8, 2);
INSERT INTO BASEPRICE VALUES('Large', 'Pan', 9, 3);
INSERT INTO BASEPRICE VALUES('Large', 'Gluten-Free', 9.5, 4);
INSERT INTO BASEPRICE VALUES('XLarge', 'Thin', 10, 2);
INSERT INTO BASEPRICE VALUES('XLarge', 'Original', 10, 3);
INSERT INTO BASEPRICE VALUES('XLarge', 'Pan', 11.5, 4.5);
INSERT INTO BASEPRICE VALUES('XLarge', 'Gluten-Free', 12.5, 6);

INSERT INTO DISCOUNT VALUES(1, 'Employee',0.15, TRUE);
INSERT INTO DISCOUNT VALUES(2, 'Lunch Special Medium', 1, FALSE);
INSERT INTO DISCOUNT VALUES(3, 'Lunch Special Large', 2, FALSE);
INSERT INTO DISCOUNT VALUES(4, 'Specialty Pizza', 1.5, FALSE);
INSERT INTO DISCOUNT VALUES(5, 'Happy Hour', 0.1, TRUE);
INSERT INTO DISCOUNT VALUES(6, 'Gameday Special', 0.2, TRUE);

# Order 1
INSERT INTO CUSTOMER VALUES(1, NULL, NULL, NULL);
INSERT INTO ORDERTABLE VALUES(1, 'Dine-in', '2025-03-05 12:03', 19.75, 3.68, TRUE, 1);
INSERT INTO DINEIN VALUES(1, 21);
INSERT INTO PIZZA VALUES(1, 'Large', 'Thin', 'Complete', '2025-03-05 12:03', 19.75, 3.68, 1);
INSERT INTO PIZZA_TOPPING VALUES(1, 13, 1);
INSERT INTO PIZZA_TOPPING VALUES(1, 1, 0);
INSERT INTO PIZZA_TOPPING VALUES(1, 2, 0);
INSERT INTO PIZZA_DISCOUNT VALUES(1, 3);
# INSERT INTO ORDER_DISCOUNT VALUES(1, 3); #do i need this even though its a pizza discount?

# Order 2
INSERT INTO CUSTOMER VALUES(2, NULL, NULL, NULL);
INSERT INTO ORDERTABLE VALUES(2, 'Dine-in','2025-04-03 12:05', 19.73, 4.63, TRUE, 2);
INSERT INTO DINEIN VALUES(2, 4);
INSERT INTO PIZZA VALUES(2, 'Medium', 'Pan', 'Complete', '2025-04-03 12:05', 12.85, 3.23, 2);
INSERT INTO PIZZA_TOPPING VALUES(2, 15, 0);
INSERT INTO PIZZA_TOPPING VALUES(2, 9, 0);
INSERT INTO PIZZA_TOPPING VALUES(2, 7, 0);
INSERT INTO PIZZA_TOPPING VALUES(2, 8, 0);
INSERT INTO PIZZA_TOPPING VALUES(2, 12, 0);
INSERT INTO PIZZA_DISCOUNT VALUES(2,2);
INSERT INTO PIZZA_DISCOUNT VALUES(2, 4);

INSERT INTO PIZZA VALUES(3, 'Small', 'Original', 'Complete', '2025-04-03 12:05', 6.93, 1.40, 2);
INSERT INTO PIZZA_TOPPING VALUES(3, 13, 0);
INSERT INTO PIZZA_TOPPING VALUES(3, 4, 0);
INSERT INTO PIZZA_TOPPING VALUES(3, 12, 0);
# Order 3
INSERT INTO CUSTOMER VALUES(3, 'Andrew', 'Wilkes-Krier', '864-254-5861');
INSERT INTO ORDERTABLE VALUES(3, 'Pickup', '2025-03-03 21:30', 89.28, 19.80, TRUE, 3);
INSERT INTO PICKUP VALUES(3, TRUE);
INSERT INTO PIZZA VALUES(4, 'Large', 'Original', 'Picked up', '2025-03-03 21:30', 14.88, 3.30, 3);
INSERT INTO PIZZA_TOPPING VALUES(4, 13, 0);
INSERT INTO PIZZA_TOPPING VALUES(4, 1, 0);
INSERT INTO PIZZA VALUES(5, 'Large', 'Original', 'Picked up', '2025-03-03 21:30', 14.88, 3.30, 3);
INSERT INTO PIZZA_TOPPING VALUES(5, 13, 0);
INSERT INTO PIZZA_TOPPING VALUES(5, 1, 0);
INSERT INTO PIZZA VALUES(6, 'Large', 'Original', 'Picked up', '2025-03-03 21:30', 14.88, 3.30, 3);
INSERT INTO PIZZA_TOPPING VALUES(6, 13, 0);
INSERT INTO PIZZA_TOPPING VALUES(6, 1, 0);
INSERT INTO PIZZA VALUES(7, 'Large', 'Original', 'Picked up', '2025-03-03 21:30', 14.88, 3.30, 3);
INSERT INTO PIZZA_TOPPING VALUES(7, 13, 0);
INSERT INTO PIZZA_TOPPING VALUES(7, 1, 0);
INSERT INTO PIZZA VALUES(8, 'Large', 'Original', 'Picked up', '2025-03-03 21:30', 14.88, 3.30, 3);
INSERT INTO PIZZA_TOPPING VALUES(8, 13, 0);
INSERT INTO PIZZA_TOPPING VALUES(8, 1, 0);
INSERT INTO PIZZA VALUES(9, 'Large', 'Original', 'Picked up', '2025-03-03 21:30', 14.88, 3.30, 3);
INSERT INTO PIZZA_TOPPING VALUES(9, 13, 0);
INSERT INTO PIZZA_TOPPING VALUES(9, 1, 0);

# Order 4
INSERT INTO ORDERTABLE VALUES(4, 'Delivery', '2025-04-20 19:11', 86.19, 20.99, TRUE, 3);
INSERT INTO DELIVERY VALUES(4, 115, 'Party Blvd', 'Anderson', 'SC', 29621, TRUE);
INSERT INTO PIZZA VALUES(10, 'XLarge', 'Original', 'Delivered', '2025-04-20 19:11', 27.94, 9.19, 4);
INSERT INTO PIZZA_TOPPING VALUES(10, 14, 0);
INSERT INTO PIZZA_TOPPING VALUES(10, 1, 0);
INSERT INTO PIZZA_TOPPING VALUES(10, 2, 0);
INSERT INTO PIZZA VALUES(11, 'XLarge', 'Original', 'Delivered', '2025-04-20 19:11', 31.50, 6.25, 4);
INSERT INTO PIZZA_TOPPING VALUES(11, 14, 0);
INSERT INTO PIZZA_TOPPING VALUES(11, 3, 1);
INSERT INTO PIZZA_TOPPING VALUES(11, 10, 1);
INSERT INTO PIZZA VALUES(12, 'XLarge', 'Original', 'Delivered', '2025-04-20 19:11', 26.75, 5.55, 4);
INSERT INTO PIZZA_TOPPING VALUES(12, 14, 0);
INSERT INTO PIZZA_TOPPING VALUES(12,4, 0);
INSERT INTO PIZZA_TOPPING VALUES(12, 17, 0);
INSERT INTO ORDER_DISCOUNT VALUES(4, 6);
INSERT INTO PIZZA_DISCOUNT VALUES(12, 4);

# Order 5
INSERT INTO CUSTOMER VALUES(4, 'Matt', 'Engers', '864-474-9953');
INSERT INTO ORDERTABLE VALUES(5, 'Pickup', '2025-03-02 17:30', 28.70, 7.84, TRUE, 4);
INSERT INTO PICKUP VALUES(5, TRUE);
INSERT INTO PIZZA VALUES(13, 'XLarge', 'Gluten-Free', 'Picked up', '2025-03-02 17:30', 28.70, 7.84, 5);
INSERT INTO PIZZA_TOPPING VALUES(13, 16, 0);
INSERT INTO PIZZA_TOPPING VALUES(13, 5, 0);
INSERT INTO PIZZA_TOPPING VALUES(13, 6, 0);
INSERT INTO PIZZA_TOPPING VALUES(13, 7, 0);
INSERT INTO PIZZA_TOPPING VALUES(13, 8, 0);
INSERT INTO PIZZA_TOPPING VALUES(13, 9, 0);
INSERT INTO PIZZA_DISCOUNT VALUES(13, 4);

# Order 6
INSERT INTO CUSTOMER VALUES(5, 'Frank', 'Turner', '864-232-8944');
INSERT INTO ORDERTABLE VALUES(6, 'Delivery','2025-03-02 18:17',25.81, 3.64, TRUE, 5);
INSERT INTO DELIVERY VALUES(6, 6745, 'Wessex St', 'Anderson','SC', 29621, TRUE);
INSERT INTO PIZZA VALUES(14, 'Large', 'Thin', 'Picked Up','2025-03-02 18:17', 25.81, 3.64, 6 );
INSERT INTO PIZZA_TOPPING VALUES(14, 4, 0);
INSERT INTO PIZZA_TOPPING VALUES(14, 5, 0);
INSERT INTO PIZZA_TOPPING VALUES(14, 6, 0);
INSERT INTO PIZZA_TOPPING VALUES(14, 8, 0);
INSERT INTO PIZZA_TOPPING VALUES(14, 14, 1);

# Order 7
INSERT INTO CUSTOMER VALUES(6, 'Milo', 'Auckerman', '864-878-5679');
INSERT INTO ORDERTABLE VALUES(7, 'Delivery','2025-04-13 20:32',37.25, 6, TRUE, 6);
INSERT INTO DELIVERY VALUES(7, 8879, 'Suburban Home', 'Anderson','SC', 29621, TRUE);
INSERT INTO PIZZA VALUES(15, 'Large', 'Thin', 'Picked Up','2025-04-13 20:32', 18, 2.75, 7 );
INSERT INTO PIZZA_TOPPING VALUES(15, 14, 1);
INSERT INTO PIZZA VALUES(16, 'Large', 'Thin', 'Picked Up','2025-04-13 20:32', 19.25, 3.25, 7 );
INSERT INTO PIZZA_TOPPING VALUES(16, 13, 0);
INSERT INTO PIZZA_TOPPING VALUES(16, 1, 1);
INSERT INTO ORDER_DISCOUNT VALUES(7, 1);